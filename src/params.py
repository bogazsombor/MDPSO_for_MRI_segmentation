# params.py
import torch
import random
from pathlib import Path

# Device and Dtype
DEVICE = torch.device("cuda" if torch.cuda.is_available() else "cpu")
DTYPE = torch.float32

# MDPSO and dimensionality parameters
MIN_DIM = 5
MAX_DIM = 10
DIM_STEP = 2
MAX_CLUST = MAX_DIM * DIM_STEP
NUM_PARTICLES = 64
MAX_ITERATION = 30
W_0 = 0.9
W_N = 0.4
C1 = 1.5
C2 = 2
VELOCITY_LIMIT = 0.03
DIM_VELOCITY_LIMIT = 2

MODALITIES = ["_flair", "_t1ce", "_t1", "_t2"]
DISTANCE_WEITGHTS = torch.tensor([0.3, 0.3, 2, 0.0, 0.63, 1], dtype=DTYPE, device=DEVICE)

BATCH = 24
CONTEXT = True
SLICE_INDEX = 77
GB_KER_SIZE = 3

# Base paths
BASE_PATH = Path("/tankstorage/user_data/bogazsombor/GNN/image_segmentation_project/")
RAW_DATA_DIR = BASE_PATH / "data" / "raw"
PREPROCESSED_DATA_DIR = "/home/boga.zsombor/data/GNN/BraTS2021Data/preprocessedData" #"BASE_PATH / "data" / "preprocessed"
CLUSTERIZATION_DIR = BASE_PATH / "data" / "clusterization"
FINAL_SEGMENTATION_DIR = BASE_PATH / "data" / "final_segmentation"
OUTPUT_DIR = BASE_PATH / "output"  # Base output directory

MRI_TYPES = ["_flair", "_seg", "_t1", "_t1ce", "_t2"]
MRI_TYPES_TO_SCALE = ["_flair", "_t1", "_t1ce", "_t2"]

HIST_UPPER = 1.0
HIST_FOR_QUANTILE_75 = 0.600
HIST_FOR_QUANTILE_25 = 0.400
HIST_LOWER = 0.0

MAX_IMAGES = 1252

codes = ['01540', '01537', '00328', '01170', '01107', '01093', '00718', '00781', '00615', '01194', '01000', '01077', '01099', '00765', '00686', '00668', '01430', '01447', '00322', '00258', '00466', '00488', '01374', '01303', '01297', '01279', '00021', '00056', '01649', '00151', '00126', '01634', '01643', '00836', '00561', '00516', '01309', '01390', '01204', '01273', '00650', '01038', '01135', '01142', '00260', '00383', '00217', '01408', '01505', '01491', '01572', '00310', '00284', '00367', '00389', '01475', '01596', '01402', '01578', '00757', '01045', '01032', '01148', '00064', '00187', '01331', '01346', '00454', '00423', '00559', '01241', '01236', '00429', '00804', '00524', '01606', '00019', '01559', '01423', '01454', '00346', '00331', '01169', '01187', '01013', '01064', '01163', '01114', '01080', '01019', '00792', '00606', '01553', '01524', '01429', '00236', '00241', '00572', '00505', '00491', '01383', '01217', '01260', '00142', '01627', '01650', '00148', '00032', '00045', '00578', '00596', '00402', '01389', '01367', '01310', '01284', '00649', '00733', '00744', '01056', '01021', '00303', '00297', '01488', '01466', '01585', '01411', '00273', '00390', '00204', '00309', '01516', '01482', '01561', '00739', '01126', '01151', '01662', '01615', '00107', '00170', 
        '01252', '01225', '01328', '00537', '00540', '01258', '01322', '01355', '00430', '00099', '00077', '00194', '00000', '01612', '01665', '00199', '00177', '00094', '00100', '01358', '01222', '01255', '00810', '00547', '00530', '01352', '01325', '01228', '00440', '01618', '00193', '00070', '00734', '00639', '01026', '01051', '00373', '00290', '00304', '00209', '01416', '01582', '01461', '00379', '00203', '00397', '00274', '01588', '01566', '01485', '01511', '01156', '01121', '00478', '00496', '00502', '00575', '01289', '01267', '01210', '01384', '00048', '00132', '01657', '01620', '00035', '00138', '00828', '00472', '00405', '00591', '01283', '01317', '01360', '01453', '01424', '01529', '00336', '00341', '01063', '01014', '01180', '01119', '00692', '00706', '01069', '01087', '01113', '01164', '00698', '00676', '00601', '00795', '01459', '01523', '01554', '00246', '00231', '00014', '00063', '01341', '01336', '00529', '00453', '00809', '01231', '01246', '00554', '00523', '00459', '00803', '01601', '00087', '00113', '00620', '00657', '01145', '01132', '01048', '00210', '00267', '00289', '01575', '01496', '01502', '01478', '00360', '00283', '00317', '01508', '01405', '01591', '01472', '00750', '00727', '01138', '01035', '01042', '00416', '00582', '01209',
        '01290', '01304', '01373', '00051', '00026', '01639', '00121', '00156', '01644', '01633', '00485', '00511', '00588', '00831', '01274', '01203', '01397', '01379', '01530', '01547', '00222', '01094', '01100', '01177', '01199', '00612', '00768', '01070', '01007', '01193', '00618', '00715', '01440', '01437', '00228', '00325', '00352', '01270', '01393', '01207', '00418', '00481', '01640', '01637', '00028', '00152', '00022', '00158', '01300', '01294', '01377', '01399', '00586', '00412', '00568', '00321', '00356', '01444', '01433', '01549', '00685', '00788', '01074', '01197', '01003', '01179', '00661', '00782', '00616', '01009', '01104', '01090', '01173', '00251', '01439', '01534', '01543', '00160', '00117', '01605', '00807', '00550', '01338', '01235', '01242', '00457', '00999', '01345', '01332', '01248', '00184', '00089', '01031', '01046', '00723', '00659', '01595', '01401', '01476', '01498', '00364', '00313', '00269', '01571', '01506', '01492', '00380', '00214', '00263', '01141', '01136', '00729', '00624', '01269', '01313', '01287', '01364', '00498', '00401', '01659', '00046', '00031', '01653', '01624', '00136', '01263', '01380', '01214', '01319', '00506', '00571', '00242', '00235', '00338', '01527', '01550', '00791', '00605', '00708', '01117', '01083',
        '01160', '00775', '01089', '01067', '01184', '01010', '00332', '01457', '01420', '00003', '00074', '00549', '00433', '00444', '01356', '01321', '00543', '00814', '01226', '01251', '00104', '00090', '00009', '01616', '01661', '01152', '01125', '01028', '00640', '01562', '01515', '01481', '01418', '00207', '00270', '01568', '01586', '01412', '01465', '00399', '00377', '00300', '00294', '01158', '01022', '01055', '00747', '00730', '01058', '01122', '01155', '00630', '01468', '01486', '01512', '01565', '00299', '01462', '01415', '01581', '01518', '00293', '00370', '01052', '01025', '01128', '00737', '00740', '00109', '00443', '00819', '00539', '01326', '01351', '00449', '00533', '00544', '01256', '01221', '00097', '00103', '01666', '01611', '00348', '01557', '01520', '00778', '00602', '00796', '00675', '01189', '01167', '01084', '01110', '00772', '00691', '00705', '00608', '01017', '01183', '01060', '00238', '01427', '01450', '01363', '01280', '01314', '01219', '00406', '01629', '00036', '01623', '01654', '00146', '00131', '01369', '01213', '01387', '01264', '00598', '00576', '00495', '00501', '01041', '01036', '00724', '00753', '01471', '01406', '01592', '00219', '00280', '00314', '01495', '01501', '01576', '01598', '00387', '00369', '01131', '01146', 
        '00654', '00623', '00759', '00084', '00110', '00167', '01602', '00520', '00557', '00800', '01245', '01232', '01348', '01238', '01335', '01342', '00060', '00017', '00183', '01608', '00351', '01539', '01434', '01443', '00682', '00716', '01109', '01004', '01190', '01073', '00611', '00688', '01174', '01097', '01103', '01079', '00221', '01544', '01533', '01449', '01200', '01394', '01277', '01299', '00565', '00512', '00468', '01630', '01647', '00155', '00122', '00058', '00128', '00025', '00052', '01370', '01293', '01307', '00518', '00581', '00838', '01600', '00112', '00165', '00068', '01247', '01230', '00555', '00802', '01337', '01340', '00528', '00452', '00808', '00425', '00118', '00062', '00751', '01139', '01043', '01034', '00282', '00316', '01509', '01473', '01404', '01590', '00266', '00211', '00288', '01497', '01503', '01574', '01479', '00656', '00621', '01133', '01144', '01049', '00567', '00510', '00830', '00589', '01202', '01396', '01275', '01378', '00157', '00120', '01632', '01645', '01638', '00417', '00583', '01208', '01372', '01291', '01305', '01436', '01441', '00353', '00324', '01192', '01071', '00619', '00680', '00714', '01176', '01095', '01101', '01198', '00613', '00787', '01546', '01531', '00254', '00359', '01619', '00071', '00006', '00192', 
        '01324', '01353', '01229', '00441', '00436', '01359', '01254', '01223', '00811', '01664', '01613', '00095', '00101', '00176', '00645', '01120', '01157', '00378', '00275', '01589', '01484', '01510', '01567', '00291', '00305', '01460', '01417', '01583', '00735', '00742', '00638', '01050', '01027', '00404', '00590', '01361', '01282', '01316', '00043', '00139', '00049', '00144', '00133', '01621', '01656', '00823', '00479', '00574', '01288', '01211', '01385', '01266', '01458', '01555', '01522', '00230', '00247', '01068', '01165', '01086', '01112', '00677', '01015', '01181', '01062', '01118', '00693', '00707', '01425', '01452', '01528', '00340', '01525', '01552', '01428', '00240', '00237', '01115', '01081', '01162', '01018', '00793', '00607', '01168', '01065', '01186', '01012', '00799', '00694', '00777', '01558', '01455', '01422', '00347', '00579', '00597', '00403', '01388', '01311', '01285', '01366', '00149', '00044', '00033', '00134', '00143', '01651', '01626', '00504', '00409', '00824', '01261', '01382', '01216', '00642', '01150', '01127', '00391', '01560', '01517', '01483', '00375', '00296', '01489', '01584', '01410', '01467', '00732', '01020', '01057', '00098', '00195', '01259', '01354', '01323', '00431', '00446', '01224', '01253', '01329', '00816', 
        '01614', '01663', '00171', '00106', '01446', '01431', '00259', '01076', '01195', '01001', '01098', '00687', '00764', '01106', '01092', '01171', '00663', '00780', '01536', '01541', '00329', '00253', '00840', '00837', '00517', '00483', '01308', '01272', '01391', '01205', '00127', '00150', '01642', '01635', '00020', '01648', '00584', '00410', '01302', '01296', '01375', '01278', '00756', '01033', '01044', '01149', '00366', '00311', '00285', '00388', '01597', '01403', '01474', '01579', '00382', '00216', '00261', '01409', '01573', '01504', '01490', '00626', '00651', '01039', '01143', '01134', '01607', '00018', '00162', '00115', '00081', '01237', '01240', '00805', '00552', '00525', '01347', '01330', '00455', '00558', '00186', '00012', '01147', '01130', '00622', '00655', '00758', '01577', '01494', '01500', '01599', '00212', '00386', '01407', '01593', '01470', '00218', '00281', '01037', '01040', '00628', '00725', '00016', '00061', '01609', '00426', '00451', '01239', '01343', '01334', '00556', '00801', '01233', '01244', '01349', '00166', '00085', '00111', '00188', '01603', '00220', '01532', '01545', '01448', '00667', '00610', '00784', '00689', '01096', '01102', '01175', '01078', '00683', '00760', '01108', '01072', '01005', '01191', '00327', '00350', '01538', 
        '01442', '01435', '01292', '01306', '01371', '00519', '00839', '00414', '00580', '00053', '00024', '01646', '01631', '00123', '00154', '00059', '01276', '01201', '01395', '01298', '00513', '00469', '01024', '01053', '01129', '00736', '01414', '01580', '01463', '01519', '00371', '00292', '00306', '01469', '01564', '01487', '01513', '00298', '00201', '00395', '01059', '01154', '01123', '00631', '00646', '00078', '00096', '00102', '01610', '00448', '00545', '00532', '01220', '01257', '00442', '00818', '00538', '01350', '01327', '00005', '00191', '00072', '00108', '00334', '00343', '00239', '01451', '01426', '00690', '00704', '00773', '01061', '01016', '01182', '00674', '00797', '01188', '01085', '01111', '01166', '00349', '00233', '01521', '01556', '01368', '01265', '01212', '01386', '00599', '00820', '00494', '00500', '00577', '01655', '01622', '00130', '00147', '01628', '01281', '01315', '01362', '01218', '00470', '00407', '00593', '01381', '01215', '01262', '01318', '00570', '00507', '00493', '01625', '01652', '00140', '00137', '01658', '00030', '01268', '01365', '01312', '01286', '00499',
        '00594', '00400', '00477', '00249', '00344', '01421', '01456', '00679', '00774', '00703', '00697', '01088', '01185', '01011', '01066', '00604', '00709', '01161', '01116', '01082', '00234', '00243', '00339', '01551', '01526', '00105', '00172', '00008', '01660', '01617', '00542', '01250', '01227', '00548', '00445', '00432', '01320', '01357', '00178', '00196', '00002', '01159', '01054', '01023', '00731', '00746', '01569', '01464', '01587', '01413', '00301', '00376', '01514', '01480', '01563', '01419', '00271', '00392', '00206', '01124', '01153', '01029', '00641', '00636', '01376', '01301', '01295', '01398', '00587', '00413', '00464', '00569', '00054', '00159', '01636', '01641', '00124', '01392', '01206', '01271', '00834', '00419', '00563', '00514', '00480', '00227', '00250', '01438', '01542', '01535', '01008', '01172', '01105', '01091', '00767', '00684', '00789', '01196', '01002', '01075', '01178', '00320', '01432', '01445', '01548', '00066', '00185', '00011', '00088', '00456', '00421', '01333', '01344', '01249', '00806', '00526', '00551', '01339', '01243', '01234', '00116', '01604', '01137', '01140', '00728', '00652', '00625', '01507', '01493', '01570', '00318', '00262', '01477', '01594', '01400', '01499', '00312', '00286', '01047', '01030', '00658']

# Shuffle and split codes for training and testing
random.shuffle(codes)
training_codes = codes[:2]
testing_codes = codes[80:81]

SAMPLE_SIZE= 10000
